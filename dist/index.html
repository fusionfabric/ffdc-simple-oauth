<html>
<head>
    <title>Sample Payment Website</title>
</head>
<body>
    <div class="header">
        <h1>Sample Payment Website</h1>
    </div>
    <div class="login">
        <button onclick="getToken()">
            Connect to FFDC
        </button>
        <p hidden id="token"></p>
    </div>
    <div class="form">
        <label>Id: </label>
        <input id="id" name="Reference" type="text" value="1545922187435">
        <label>Amount: </label>
        <input id="amount" name="Amount" type="text" value="100">
        <label>Payee: </label>
        <input id="debtor" name="Reference" type="text" value="Dbtr Name">
        <label>Payer: </label>
        <input id="creditor" name="Reference" type="text" value="Cdtr Name">
        <label>Currency: </label>
        <input id="currency" type=text list="existing">
        <datalist id="existing">
            <option value="USD"></option>
            <option value="EUR"></option>
            <option value="CAD"></option>
        </datalist>
        <button onclick="sendPayment()">Send Payment</button>
    </div>
    <div class="resultat">
        <p id="res"></p>
        <p id="RessourceId"></p>
        <p id="status"></p>
        <p id="info"></p>
    </div>
    <script>
        async function getToken() {
            var result = await fetch("http://localhost:8000/api/login");
            var res = await result.json();
            document.getElementById("token").innerHTML=res.token;
        }
        async function sendPayment() {
            if (document.getElementById("token").innerText != "") {
                const params = {
                    token: document.getElementById("token").innerText,
                    amount: document.getElementById("amount").innerText 
                };
                console.log(params);
                const options = {
                    method: 'POST',
                    body:  JSON.stringify(params),
                    headers: {
                        "Content-type": "application/json"
                    }  
                };
                var result = await fetch("http://localhost:8000/api/payment", options );
                var res = await result.json();
                console.log(res);
                document.getElementById("info").innerText="Infos: "+res.statusReasonAdditionalInformation;
                document.getElementById("RessourceId").innerText="Payment Id: "+res.paymentResourceId;
                document.getElementById("status").innerText="Status: "+res.status;
                document.getElementById("res").innerHTML="";
            } else {
                document.getElementById("res").innerHTML="You are not connected to FFDC!";
            }
        }
    </script>
</body>
</html>